import requests
import json
import base64

# Base URL of the Flask app
BASE_URL = 'http://localhost:55500'
SAVE_NAME = "test_run"
def encode_image(path: str) -> str:
    with open(path, 'rb') as f:
        return base64.b64encode(f.read()).decode('utf-8')

# Test image-to-spec endpoint
def test_image_to_spec(image_path):
    img_b64 = encode_image(image_path)
    payload = {
        "image": img_b64,
        "save_name": SAVE_NAME
    }
    resp = requests.post(f'{BASE_URL}/api/image_to_spec', json=payload)
    resp.raise_for_status()
    data = resp.json()
    print("=== /image_to_spec ===")
    print(json.dumps(data, ensure_ascii=False, indent=2))
    return data['spec']

# Test edit-spec endpoint
def test_edit_spec(spec, text, name='test123'):
    payload = {
        'text': text,
        'spec': spec,
        "save_name": name
    }
    response = requests.post(
        f'{BASE_URL}/api/edit_spec',
        json=payload
    )
    print('edit_spec status:', response.status_code)
    print('Response:', response.json())
    return response.json().get('spec')

# Test combine-spec endpoint
def test_combine_spec(spec_list):
    response = requests.post(
        f'{BASE_URL}/api/combine_spec',
        json={'spec_list': spec_list}
    )
    print('combine_spec status:', response.status_code)
    print('Response:', response.json())
    return response.json().get('spec')

# Test generate-code endpoint
def test_generate_code(spec, save_name='test_run'):
    payload = {
        'spec': spec,
        'save_name': save_name
    }
    response = requests.post(
        f'{BASE_URL}/api/generate_code',
        json=payload
    )
    print('generate_code status:', response.status_code)
    data = response.json()
    print('Response:', data)
    # Save returned code and image if present
    code = data.get('code')
    img_b64 = data.get('render_image')
    if code:
        with open('generated_code.jsx', 'w', encoding='utf-8') as f:
            f.write(code)
        print('Saved generated_code.jsx')
    if img_b64:
        img_bytes = base64.b64decode(img_b64)
        with open('render_image.png', 'wb') as f:
            f.write(img_bytes)
        print('Saved render_image.png')
    return data

if __name__ == '__main__':
    # 1. Test image_to_spec
    # spec1 = test_image_to_spec('/media/sda5/cyn-workspace/UI-SPEC/test_img/image/0001.jpeg')
    spec1 = """
{\n  \"UI描述\": {\n    \"整体描述\": \"该界面是名为“Master NCE”的网络设备管理平台中的“剥线按键”页面，属于监控与管理模块。页面整体布局为常见的三栏式结构，左侧为可折叠的功能导航栏，中间及右侧为核心数据展示和操作功能区域。侧重展示剥线按键设备的状态概览、性能指标以及详细的设备数据列表，便于运维人员实时监控和管理。\",\n    \"功能简述\": \"页面实现对剥线按键设备的健康度及负载指标的综合监控，提供关键指标的可视化环形进度图，结合折线图展示动态趋势，并通过表格详细展现单台设备的状态和参数，支持状态筛选及设备的操作管理。\",\n    \"产品场景\": \"适用于网络设备运维人员和管理员实时监控剥线按键设备的运行状态，快速定位设备异常，进行维护和性能分析。\",\n    \"目标用户\": \"网络运维工程师、设备管理员及技术支持人员，具备一定的网络设备基础知识，需要通过仪表盘快速掌握设备运行情况。\",\n    \"核心功能\": \"1. 剥线按键设备的综合健康度评分和负载度评分的实时监测。2. 通过环形进度图直观展示核心指标。3. 折线图反映负载压力的时间趋势。4. 设备数据列表的详细信息浏览与状态筛选。5. 支持设备的编辑、删除等操作。\"\n  },\n  \"页面构成\": {\n    \"区域划分\": [\n      {\n        \"区域编号\": \"1\",\n        \"区域名称\": \"顶部导航栏\",\n        \"区域所在页面位置\": \"页面最顶部水平全宽，占页面高度约5%。水平排列，左侧为产品Logo与名称，中间为导航菜单，右侧为用户信息及操作按钮。\",\n        \"区域内各组件布局\": \"从左到右依次排列：Logo+产品名称，主导航菜单，辅助菜单项，用户头像+用户名+下拉操作。各部分之间保持合理间距且垂直居中。\",\n        \"包含组件\": [\n          {\n            \"组件编号\": \"1.1\",\n            \"组件类型\": \"Ant Design Menu\",\n            \"承担的功能\": \"实现页面功能模块之间的导航切换。\",\n            \"承载的信息\": {\n              \"菜单项\": [\"首页\", \"剥线\", \"备件\", \"指标\", \"告警\", \"设置\"],\n              \"当前激活项\": \"剥线\"\n            },\n            \"组件的配色样式\": \"背景色为纯白，字体颜色为深灰色，激活项字体为品牌蓝色，悬浮时变浅蓝色。\",\n            \"组件所处的位置\": \"位于顶部导航区域正中偏左，宽度占该区域约70%，高度100%。\",\n            \"组件内的布局样式\": \"横向排列的菜单项左对齐，菜单项间距均匀，字体大小适中，垂直居中。\"\n          },\n          {\n            \"组件编号\": \"1.2\",\n            \"组件类型\": \"Ant Design Dropdown with Avatar\",\n            \"承担的功能\": \"显示当前登录用户信息，提供用户相关操作菜单。\",\n            \"承载的信息\": {\n              \"用户名\": \"Admin\",\n              \"用户头像\": \"默认头像图标\",\n              \"操作项\": [\"个人中心\", \"设置\", \"退出登录\"]\n            },\n            \"组件的配色样式\": \"字体颜色深灰色，头像为灰蓝色圆形图标，悬浮时背景浅灰色。\",\n            \"组件所处的位置\": \"位于顶部导航区域右侧，距离右边缘适中，宽度约占5%，高度100%。\",\n            \"组件内的布局样式\": \"头像和用户名横向排列，用户名在头像右侧，二者垂直居中，点击触发展示下拉菜单。\"\n          }\n        ]\n      },\n      {\n        \"区域编号\": \"2\",\n        \"区域名称\": \"左侧功能导航栏\",\n        \"区域所在页面位置\": \"页面左侧纵向栏，宽度约占页面总宽度的12%，高度覆盖内容区，全高，位于顶部导航栏下方，左侧贴边。\",\n        \"区域内各组件布局\": \"垂直排列多个导航项，包含主分类和子分类。左侧空间较窄，组件文字及图标左对齐，导航项间垂直间距适中。\",\n        \"包含组件\": [\n          {\n            \"组件编号\": \"2.1\",\n            \"组件类型\": \"Ant Design Menu (inline模式)\",\n            \"承担的功能\": \"实现针对不同功能模块的导航分类，支持展开收起子菜单。\",\n            \"承载的信息\": {\n              \"一级菜单项\": [\n                { \"key\":\"0\", \"title\":\"概览\" },\n                { \"key\":\"1\", \"title\":\"剥线\", \"children\": [\n                  { \"key\":\"1-0\", \"title\":\"剥线按键\" },\n                  { \"key\":\"1-1\", \"title\":\"剥线批次\" }\n                ]},\n                { \"key\":\"2\", \"title\":\"备件\" },\n                { \"key\":\"3\", \"title\":\"设置\" }\n              ],\n              \"当前选中项\": \"1-0 剥线按键\"\n            },\n            \"组件的配色样式\": \"背景为深蓝色，字体为浅灰色，选中项高亮为品牌蓝，鼠标悬浮时文字变为白色。\",\n            \"组件所处的位置\": \"占据左侧导航区域全部，宽度为100%，高度100%。\",\n            \"组件内的布局样式\": \"纵向排列，子菜单缩进约16px，文本左对齐，图标放置于文字左侧。\"\n          }\n        ]\n      },\n      {\n        \"区域编号\": \"3\",\n        \"区域名称\": \"主内容区\",\n        \"区域所在页面位置\": \"页面中间及右侧主体部分，宽度占页面剩余约88%，高度覆盖剩余空间，顶部紧靠顶部导航栏，下方填满页面。\",\n        \"区域内各组件布局\": \"内容区自上而下分布，但视觉上分为两部分：一是前顶的三个指标及图表并排(宽度1:1:1)，下方为占满宽度的设备数据表格。三个指标区横向平分宽度，垂直间距适中；表格横向铺满宽度，纵向占内容区大部分空间。\",\n        \"包含组件\": [\n          {\n            \"组件编号\": \"3.1\",\n            \"组件类型\": \"Ant Design Card + Recharts Ring Chart (环形进度图)\",\n            \"承担的功能\": \"展示整体健康度指标和负载度指标的状态数值与环形进度百分比。\",\n            \"承载的信息\": {\n              \"第一张卡片\": {\n                \"标题\": \"设备健康度\",\n                \"百分比\": \"84%\",\n                \"分数\": 84,\n                \"说明文字\": \"健康\"\n              },\n              \"第二张卡片\": {\n                \"标题\": \"设备负载度\",\n                \"百分比\": \"57%\",\n                \"分数\": 57,\n                \"说明文字\": \"负载\"\n              }\n            },\n            \"组件的配色样式\": \"卡片背景白色，圆环进度颜色分别为绿色偏暖（健康度）和蓝绿色（负载度），未填充环为浅灰色。文字颜色深灰，数值部分字体粗体。\",\n            \"组件所处的位置\": \"三个卡片位于主区域顶部左侧至中间，宽度各占33%，高度为该部分区域的100%。第1张和第2张卡片分别占左两份宽度中每份。\",\n            \"组件内的布局样式\": \"卡片内垂直居中安排，环形图居中偏上，下面居中显示数字百分比和说明文字，整体为纵向排列。\"\n          },\n          {\n            \"组件编号\": \"3.2\",\n            \"组件类型\": \"Ant Design Card + Recharts Bar Chart\",\n            \"承担的功能\": \"展示Top用户的负载度时间趋势，反映各时间节点的负载压力。\",\n            \"承载的信息\": {\n              \"图表标题\": \"Top用户负载压力变化\",\n              \"数据条目\": [\n                { \"日期\": \"3月1日\", \"负载\": 80, \"阈值\": 100 },\n                { \"日期\": \"3月2日\", \"负载\": 90, \"阈值\": 100 },\n                { \"日期\": \"3月3日\", \"负载\": 75, \"阈值\": 100 },\n                { \"日期\": \"3月4日\", \"负载\": 85, \"阈值\": 100 },\n                { \"日期\": \"3月5日\", \"负载\": 95, \"阈值\": 100 }\n              ]\n            },\n            \"组件的配色样式\": \"框架为白底卡片，柱状条为蓝色，阈值以红色线条标示，坐标字体为深灰色。\",\n            \"组件所处的位置\": \"位于主内容区顶部右侧三分之一宽度部分，与3.1水平排列，宽度占33%，高度100%。\",\n            \"组件内的布局样式\": \"图表居中，横轴显示时间，纵轴显示数值，柱状图与阈值线叠加，标题在卡片顶部居中。\"\n          },\n          {\n            \"组件编号\": \"3.3\",\n            \"组件类型\": \"Ant Design Table\",\n            \"承担的功能\": \"展示剥线按键设备的详细列表，支持查看设备具体属性和状态，进行控制操作。\",\n            \"承载的信息\": {\n              \"总行数\": 10,\n              \"表头\": [\n                \"设备名称\",\n                \"设备ID\",\n                \"状态\",\n                \"在线状态\",\n                \"版本号\",\n                \"最近更新时间\",\n                \"操作\"\n              ],\n              \"表体数据\": [\n                { \"设备名称\": \"Slice 01\", \"设备ID\": \"12\", \"状态\": \"正常\", \"在线状态\": \"在线\", \"版本号\": \"0.7.0\", \"最近更新时间\": \"2023-11-10 16:45:31\", \"操作\": [\"编辑\", \"删除\"] },\n                { \"设备名称\": \"Slice 02\", \"设备ID\": \"13\", \"状态\": \"异常\", \"在线状态\": \"离线\", \"版本号\": \"0.7.0\", \"最近更新时间\": \"2023-11-10 16:45:31\", \"操作\": [\"编辑\", \"删除\"] },\n                { \"设备名称\": \"Slice 03\", \"设备ID\": \"14\", \"状态\": \"正常\", \"在线状态\": \"在线\", \"版本号\": \"0.7.0\", \"最近更新时间\": \"2023-11-10 16:45:31\", \"操作\": [\"编辑\", \"删除\"] },\n                { \"设备名称\": \"Slice 04\", \"设备ID\": \"15\", \"状态\": \"故障\", \"在线状态\": \"离线\", \"版本号\": \"0.7.0\", \"最近更新时间\": \"2023-11-10 16:45:31\", \"操作\": [\"编辑\", \"删除\"] },\n                { \"设备名称\": \"Slice 05\", \"设备ID\": \"16\", \"状态\": \"正常\", \"在线状态\": \"在线\", \"版本号\": \"0.7.0\", \"最近更新时间\": \"2023-11-10 16:45:31\", \"操作\": [\"编辑\", \"删除\"] },\n                { \"设备名称\": \"Slice 06\", \"设备ID\": \"17\", \"状态\": \"正常\", \"在线状态\": \"在线\", \"版本号\": \"0.7.0\", \"最近更新时间\": \"2023-11-10 16:45:31\", \"操作\": [\"编辑\", \"删除\"] },\n                { \"设备名称\": \"Slice 07\", \"设备ID\": \"18\", \"状态\": \"异常\", \"在线状态\": \"离线\", \"版本号\": \"0.7.0\", \"最近更新时间\": \"2023-11-10 16:45:31\", \"操作\": [\"编辑\", \"删除\"] },\n                { \"设备名称\": \"Slice 08\", \"设备ID\": \"19\", \"状态\": \"正常\", \"在线状态\": \"在线\", \"版本号\": \"0.7.0\", \"最近更新时间\": \"2023-11-10 16:45:31\", \"操作\": [\"编辑\", \"删除\"] },\n                { \"设备名称\": \"Slice 09\", \"设备ID\": \"20\", \"状态\": \"正常\", \"在线状态\": \"在线\", \"版本号\": \"0.7.0\", \"最近更新时间\": \"2023-11-10 16:45:31\", \"操作\": [\"编辑\", \"删除\"] },\n                { \"设备名称\": \"切换全部\", \"设备ID\": \"\", \"状态\": \"\", \"在线状态\": \"\", \"版本号\": \"\", \"最近更新时间\": \"\", \"操作\": [] }\n              ]\n            },\n            \"组件的配色样式\": \"表格背景白色，表头字体深灰色加粗，行文字中灰色。状态字段有不同背景色：正常为绿色，异常为红色，故障为暗红色，在线状态绿色，离线红色。操作按钮为浅灰背景，悬浮变蓝色字体。\",\n            \"组件所处的位置\": \"位于主内容区下半部分，占据该区域80%宽度，宽度100%，高度约为主内容区的60%，紧邻指标部分下方，水平铺满。\",\n            \"组件内的布局样式\": \"表格为标准纵向列表样式，列宽适中均匀分布，含分页控件位于表格右下角，支持操作列按钮右对齐排列，表头固定。\"\n          }\n        ]\n      }\n    ]\n  },\n  \"视觉风格\": {\n    \"整体调性\": \"专业、简洁和现代化，主要面向企业级网络管理用户，强调数据的清晰和操作的直观。\",\n    \"色彩体系\": \"主色调为品牌蓝色，鲜明且稳重。背景多为纯白及浅灰色，文字以深灰和中灰色为主，进度环使用绿色、蓝绿色和红色等高辨识度色彩区分状态。导航背景为深蓝色，强调层级区分。操作按钮采用浅灰色为默认，悬浮时过渡至蓝色调，增强交互反馈。\",\n    \"设计风格\": \"遵循Ant Design规范，采用卡片式布局与模块化设计。版面空间宽松，控件间距适中，图表与表格清晰分区。元素边角采用圆角，具有一定的亲和力。信息层级通过颜色和文字粗细体现，界面整体风格庄重且现代，符合技术运维管理系统设计需求。\"\n  }\n}
"""
    # 2. Test edit_spec (using the spec returned above)
    # spec2 = test_edit_spec(json.loads(spec1), text='将柱状图换成美观的折线图', name='test123')
    spec2 = """
{'spec': {'UI描述': {'产品场景': '适用于网络设备运维人员和管理员实时监控剥线按键设备的运行状态，快速定位设备异常，进行维护和性能分析。', '功能简述': '页面实现对剥线按键设备的健康度及负载指标的综合监控，提供关键指标的可视化环形进度图，结合折线图展示动态趋势，并通过表格详细展现单台设备的状态和参数，支持状态筛选及设备的操作管理。', '整体描述': '该界面是名为“Master NCE”的网络设备管理平台中的“剥线按键”页面，属于监控与管理模块。页面整体布局为常见的三栏式结构，左侧为可折叠的功能导航栏，中间及右侧为核心数据展示和操作功能区域。侧重展示剥线按键设备的状态概览、性能指标以及详细的设备数据列表，便于运维人员实时监控和管理。', '核心功能': '1. 剥线按键设备的综合健康度评分和负载度评分的实时监测。2. 通过环形进度图直观展示核心指标。3. 折线图反映负载压力的时间趋势。4. 设备数据列表的详细信息浏览与状态筛选。5. 支持设备的编辑、删除等操作。', '目标用户': '网络运维工程师、设备管理员及技术支持人员，具备一定的网络设备基础知识，需要通过仪表盘快速掌握设备运行情况。'}, '视觉风格': {'整体调性': '专业、简洁和现代化，主要面向企业级网络管理用户，强调数据的清晰和操作的直观。', '色彩体系': '主色调为品牌蓝色，鲜明且稳重。背景多为纯白及浅灰色，文字以深灰和中灰色为主，进度环使用绿色、蓝绿色和红色等高辨识度色彩区分状态。导航背景为深蓝色，强调层级区分。操作按钮采用浅灰色为默认，悬浮时过渡至蓝色调，增强交互反馈。', '设计风格': '遵循Ant Design规范，采用卡片式布局与模块化设计。版面空间宽松，控件间距适中，图表与表格清晰分区。元素边角采用圆角，具有一定的亲和力。信息层级通过颜色和文字粗细体现，界面整体风格庄重且现代，符合技术运维管理系统设计需求。'}, '页面构成': {'区域划分': [{'包含组件': [{'承担的功能': '实现页面功能模块之间的导航切换。', '承载的信息': {'当前激活项': '剥线', '菜单项': ['首页', '剥线', '备件', '指标', '告警', '设置']}, '组件内的布局样式': '横向排列的菜单项左对齐，菜单项间距均匀，字体大小适中，垂直居中。', '组件所处的位置': '位于顶部导航区域正中偏左，宽度占该区域约70%，高度100%。', '组件的配色样式': '背景色为纯白，字体颜色为深灰色，激活项字体为品牌蓝色，悬浮时变浅蓝色。', '组件类型': 'Ant Design Menu', '组件编号': '1.1'}, {'承担的功能': '显示当前登录用户信息，提供用户相关操作菜单。', '承载的信息': {'操作项': ['个人中心', '设置', '退出登录'], '用户名': 'Admin', '用户头像': '默认头像图标'}, '组件内的布局样式': '头像和用户名横向排列，用户名在头像右侧，二者垂直居中，点击触发展示下拉菜单。', '组件所处的位置': '位于顶部导航区域右侧，距离右边缘适中，宽度约占5%，高度100%。', '组件的配色样式': '字体颜色深灰色，头像为灰蓝色圆形图标，悬浮时背景浅灰色。', '组件类型': 'Ant Design Dropdown with Avatar', '组件编号': '1.2'}], '区域内各组件布局': '从左到右依次排列：Logo+产品名称，主导航菜单，辅助菜单项，用户头像+用户名+下拉操作。各部分之间保持合理间距且垂直居中。', '区域名称': '顶部导航栏', '区域所在页面位置': '页面最顶部水平全宽，占页面高度约5%。水平排列，左侧为产品Logo与名称，中间为导航菜单，右侧为用户信息及操作按钮。', '区域编号': '1'}, {'包含组件': [{'承担的功能': '实现针对不同功能模块的导航分类，支持展开收起子菜单。', '承载的信息': {'一级菜单项': [{'key': '0', 'title': '概览'}, {'children': [{'key': '1-0', 'title': '剥线按键'}, {'key': '1-1', 'title': '剥线批次'}], 'key': '1', 'title': '剥线'}, {'key': '2', 'title': '备件'}, {'key': '3', 'title': '设置'}], '当前选中项': '1-0 剥线按键'}, '组件内的布局样式': '纵向排列，子菜单缩进约16px，文本左对齐，图标放置于文字左侧。', '组件所处的位置': '占据左侧导航区域全部，宽度为100%，高度100%。', '组件的配色样式': '背景为深蓝色，字体为浅灰色，选中项高亮为品牌蓝，鼠标悬浮时文字变为白色。', '组件类型': 'Ant Design Menu (inline模式)', '组件编号': '2.1'}], '区域内各组件布局': '垂直排列多个导航项，包含主分类和子分类。左侧空间较窄，组件文字及图标左对齐，导航项间垂直间距适中。', '区域名称': '左侧功能导航栏', '区域所在页面位置': '页面左侧纵向栏，宽度约占页面总宽度的12%，高度覆盖内容区，全高，位于顶部导航栏下方，左侧贴边。', '区域编号': '2'}, {'包含组件': [{'承担的功能': '展示整体健康度指标和负载度指标的状态数值与环形进度百分比。', '承载的信息': {'第一张卡片': {'分数': 84, '标题': '设备健康度', '百分比': '84%', '说明文字': '健康'}, '第二张卡片': {'分数': 57, '标题': '设备负载度', '百分比': '57%', '说明文字': '负载'}}, '组件内的布局样式': '卡片内垂直居中安排，环形图居中偏上，下面居中显示数字百分比和说明文字，整体为纵向排列。', '组件所处的位置': '三个卡片位于主区域顶部左侧至中间，宽度各占33%，高度为该部分区域的100%。第1张和第2张卡片分别占左两份宽度中每份。', '组件的配色样式': '卡片背景白色，圆环进度颜色分别为绿色偏暖（健康度）和蓝绿色（负载度），未填充环为浅灰色。文字颜色深灰，数值部分字体粗体。', '组件类型': 'Ant Design Card + Recharts Ring Chart (环形进度图)', '组件编号': '3.1'}, {'承担的功能': '展示Top用户的负载度时间趋势，反映各时间节点的负载压力。', '承载的信息': {'图表标题': 'Top用户负载压力变化', '数据条目': [{'日期': '3月1日', '负载': 80, '阈值': 100}, {'日期': '3月2日', '负载': 90, '阈值': 100}, {'日期': '3月3日', '负载': 75, '阈值': 100}, {'日期': '3月4日', '负载': 85, '阈值': 100}, {'日期': '3月5日', '负载': 95, '阈值': 100}]}, '组件内的布局样式': '图表居中，横轴显示时间，纵轴显示数值，柱状图与阈值线叠加，标题在卡片顶部居中。', '组件所处的位置': '位于主内容区顶部右侧三分之一宽度部分，与3.1水平排列，宽度占33%，高度100%。', '组件的配色样式': '框架为白底卡片，柱状条为蓝色，阈值以红色线条标示，坐标字体为深灰色。', '组件类型': 'Ant Design Card + Recharts Line Chart', '组件编号': '3.2'}, {'承担的功能': '展示剥线按键设备的详细列表，支持查看设备具体属性和状态，进行控制操作。', '承载的信息': {'总行数': 10, '表体数据': [{'在线状态': '在线', '操作': ['编辑', '删除'], '最近更新时间': '2023-11-10 16:45:31', '版本号': '0.7.0', '状态': '正常', '设备ID': '12', '设备名称': 'Slice 01'}, {'在线状态': '离线', '操作': ['编辑', '删除'], '最近更新时间': '2023-11-10 16:45:31', '版本号': '0.7.0', '状态': '异常', '设备ID': '13', '设备名称': 'Slice 02'}, {'在线状态': '在线', '操作': ['编辑', '删除'], '最近更新时间': '2023-11-10 16:45:31', '版本号': '0.7.0', '状态': '正常', '设备ID': '14', '设备名称': 'Slice 03'}, {'在线状态': '离线', '操作': ['编辑', '删除'], '最近更新时间': '2023-11-10 16:45:31', '版本号': '0.7.0', '状态': '故障', '设备ID': '15', '设备名称': 'Slice 04'}, {'在线状态': '在线', '操作': ['编辑', '删除'], '最近更新时间': '2023-11-10 16:45:31', '版本号': '0.7.0', '状态': '正常', '设备ID': '16', '设备名称': 'Slice 05'}, {'在线状态': '在线', '操作': ['编辑', '删除'], '最近更新时间': '2023-11-10 16:45:31', '版本号': '0.7.0', '状态': '正常', '设备ID': '17', '设备名称': 'Slice 06'}, {'在线状态': '离线', '操作': ['编辑', '删除'], '最近更新时间': '2023-11-10 16:45:31', '版本号': '0.7.0', '状态': '异常', '设备ID': '18', '设备名称': 'Slice 07'}, {'在线状态': '在线', '操作': ['编辑', '删除'], '最近更新时间': '2023-11-10 16:45:31', '版本号': '0.7.0', '状态': '正常', '设备ID': '19', '设备名称': 'Slice 08'}, {'在线状态': '在线', '操作': ['编辑', '删除'], '最近更新时间': '2023-11-10 16:45:31', '版本号': '0.7.0', '状态': '正常', '设备ID': '20', '设备名称': 'Slice 09'}, {'在线状态': '', '操作': [], '最近更新时间': '', '版本号': '', '状态': '', '设备ID': '', '设备名称': '切换全部'}], '表头': ['设备名称', '设备ID', '状态', '在线状态', '版本号', '最近更新时间', '操作']}, '组件内的布局样式': '表格为标准纵向列表样式，列宽适中均匀分布，含分页控件位于表格右下角，支持操作列按钮右对齐排列，表头固定。', '组件所处的位置': '位于主内容区下半部分，占据该区域80%宽度，宽度100%，高度约为主内容区的60%，紧邻指标部分下方，水平铺满。', '组件的配色样式': '表格背景白色，表头字体深灰色加粗，行文字中灰色。状态字段有不同背景色：正常为绿色，异常为红色，故障为暗红色，在线状态绿色，离线红色。操作按钮为浅灰背景，悬浮变蓝色字体。', '组件类型': 'Ant Design Table', '组件编号': '3.3'}], '区域内各组件布局': '内容区自上而下分布，但视觉上分为两部分：一是前顶的三个指标及图表并排(宽度1:1:1)，下方为占满宽度的设备数据表格。三个指标区横向平分宽度，垂直间距适中；表格横向铺满宽度，纵向占内容区大部分空间。', '区域名称': '主内容区', '区域所在页面位置': '页面中间及右侧主体部分，宽度占页面剩余约88%，高度覆盖剩余空间，顶部紧靠顶部导航栏，下方填满页面。', '区域编号': '3'}]}}}
"""
    # 3. Test combine_spec (stringify specs for this test)
    # spec_list = [json.dumps(spec1), json.dumps(spec2)]
    # combined_spec = test_combine_spec(spec_list)

    # 4. Test generate_code
    # test_generate_code(spec1, save_name='test123')

    test_generate_code(spec2, save_name='test123')
