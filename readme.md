# ğŸ§  UI-SPEC åç«¯æœåŠ¡æ–‡æ¡£

## ğŸ“Œ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®åŸºäº Flask æ­å»ºï¼Œæ˜¯ä¸€ä¸ªç”¨äºå°† UI æˆªå›¾æˆ–æ–‡æœ¬æè¿°æ™ºèƒ½è½¬åŒ–ä¸º UI è®¾è®¡è§„èŒƒï¼ˆSPECï¼‰å’Œå¯è¿è¡Œä»£ç çš„åç«¯æœåŠ¡ã€‚è¯¥ç³»ç»Ÿä¾èµ– GPT æ¨¡å‹è¿›è¡Œæ™ºèƒ½æ¨ç†ï¼Œæ”¯æŒ UI åŒºåŸŸæå–ã€å¸ƒå±€ä¼˜åŒ–ã€ç»„ä»¶è¯†åˆ«ã€ä»£ç ç”Ÿæˆç­‰å¤šä¸ªå­ä»»åŠ¡ï¼Œæœ€ç»ˆç›®æ ‡æ˜¯å®ç° UI è®¾è®¡çš„è‡ªåŠ¨åŒ–ç”Ÿæˆä¸ä¼˜åŒ–ã€‚

---

## ğŸ“‚ ç›®å½•ç»“æ„æ¦‚è§ˆ

```bash
.
â”œâ”€â”€ app.py                    # ä¸»åº”ç”¨å…¥å£ï¼ŒåŒ…å«æ‰€æœ‰APIè·¯ç”±
â”‚   infer_llm.py      # å°è£…æ¨¡å‹è°ƒç”¨ä¸æ¨ç†é€»è¾‘
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ gpt_api.py            # å°è£… GPT æ¥å£è°ƒç”¨
â”‚   â”œâ”€â”€ prompt.py             # å„ç§ prompt æ¨¡æ¿
â”œâ”€â”€ code_gen/
â”‚   â”œâ”€â”€ gen_code.py           # ç”Ÿæˆ React ä»£ç 
â”‚   â””â”€â”€ code_debug.py         # è‡ªåŠ¨è¿è¡Œå¹¶æˆªå›¾è°ƒè¯• React åº”ç”¨
â”œâ”€â”€ spec_editor/
â”‚   â””â”€â”€ edit_ui_spec_v2.py    # ç¼–è¾‘ UI è§„èŒƒæ ‘
â””â”€â”€ backend_results/
    â””â”€â”€ image-results/        # æ¨ç†ä¸æ¸²æŸ“ç»“æœå­˜å‚¨ç›®å½•
```

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨

```bash
pip install -r requirements.txt
python app.py
# æœåŠ¡é»˜è®¤è¿è¡Œåœ¨ http://0.0.0.0:55500
```

---

## ğŸŒ API è¯´æ˜æ–‡æ¡£

### 1. `POST /api/image_to_spec`

> ä¸Šä¼ å›¾ç‰‡ï¼Œæå–å®Œæ•´çš„ UI SPECï¼ˆç»“æ„åŒ–é¡µé¢è§„èŒƒï¼‰

* **è¯·æ±‚å‚æ•°**

```json
{
  "image": "<base64ç¼–ç å›¾åƒ>",
  "save_name": "my_dashboard"
}
```

* **è¿”å›ç¤ºä¾‹**

```json
{
  "success": true,
  "data": {
    "spec": { ... }  // JSONæ ¼å¼çš„UIç»“æ„
  }
}
```

---

### 2. `POST /api/adjust_spec_layout`

> æ ¹æ®åŒºåŸŸçš„ BBox å¤§å°è‡ªåŠ¨ä¼˜åŒ–å¸ƒå±€æè¿°å­—æ®µ

* **è¯·æ±‚å‚æ•°**

```json
{
  "spec": { ... }  // åŸå§‹ UI è§„èŒƒ
}
```

* **è¿”å›**

```json
{
  "success": true,
  "data": {
    "spec": { ... }  // å¸ƒå±€ä¼˜åŒ–åçš„æ–°è§„èŒƒ
  }
}
```

---

### 3. `POST /api/text_to_spec`

> å°†ç”¨æˆ·æ–‡æœ¬æè¿°è½¬æ¢ä¸º UI è§„èŒƒ

* **è¯·æ±‚**

```json
{
  "text": "æˆ‘éœ€è¦ä¸€ä¸ªé”€å”®æ•°æ®ä»ªè¡¨ç›˜...",
  "save_name": "text_dash"
}
```

* **è¿”å›**

```json
{
  "success": true,
  "data": {
    "spec": { ... }
  }
}
```

---

### 4. `POST /api/edit_spec`

> ç¼–è¾‘ç°æœ‰ UI è§„èŒƒï¼ˆæ ¹æ®æ„å›¾æ–‡æœ¬ï¼‰

```json
{
  "text": "æŠŠç¬¬ä¸€ä¸ªå›¾è¡¨æ¢æˆæŠ˜çº¿å›¾",
  "spec": { ... },
  "save_name": "chart_edit"
}
```

---

### 5. `POST /api/combine_spec`

> åˆå¹¶å¤šä¸ª SPEC ä¸ºä¸€ä¸ªæ•´ä½“é¡µé¢ç»“æ„

```json
{
  "spec_list": ["spec1ç»“æ„", "spec2ç»“æ„..."],
  "save_name": "combined_spec"
}
```

---

### 6. `POST /api/generate_code`

> æ ¹æ® UI è§„èŒƒç”Ÿæˆ React é¡µé¢ä»£ç ï¼Œå¹¶è¿”å›æˆªå›¾

```json
{
  "spec": { ... },
  "save_name": "final_ui"
}
```

* **è¿”å›**

```json
{
  "code": "// React + AntD ä»£ç ",
  "render_image": "<base64æˆªå›¾>"
}
```

---

## ğŸ“š Prompt ç±»å‹è¯´æ˜ï¼ˆç”± GPT ä½¿ç”¨ï¼‰

| Prompt åç§°                      | åŠŸèƒ½æè¿°                 |
| ------------------------------ | -------------------- |
| `spec_prompt_CYN`              | ä»å›¾ç‰‡ä¸­æå–å®Œæ•´ UI ç»“æ„è§„èŒƒ     |
| `text_to_spec_prompt`          | ä»æ–‡æœ¬è½¬ UI ç»“æ„è§„èŒƒ         |
| `adjust_layout_by_bbox_prompt` | æ ¹æ® BBox è‡ªåŠ¨ä¼˜åŒ–å¸ƒå±€å­—æ®µ     |
| `merge_prompt`                 | åˆå¹¶å¤šä¸ª UI è§„èŒƒæè¿°         |
| `division_prompt_v2`           | æå–åŒºåŸŸ/ç»„ä»¶ä¿¡æ¯ç»“æ„          |
| `code_prompt_web_v8`           | å°† SPEC è½¬ä¸ºå‰ç«¯ React ä»£ç  |

---

## ğŸ—‚ï¸ ç»“æœå­˜å‚¨è·¯å¾„

* åŸå›¾ã€æ¨ç†ç»“æœã€æˆªå›¾ã€ç”Ÿæˆä»£ç ï¼š

  ```
  /media/sda5/cyn-workspace/UI-SPEC/backend_results/image-results/
  ```
